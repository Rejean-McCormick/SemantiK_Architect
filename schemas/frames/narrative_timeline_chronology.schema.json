{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://abstract-wiki.org/schemas/frames/narrative_timeline_chronology.schema.json",
  "title": "Timeline / chronology aggregate frame",
  "description": "Language-agnostic aggregate frame representing a chronological sequence of events about some subject. Mirrors semantics.narrative.timeline_chronology_frame.TimelineChronologyFrame and TimelineEntry.",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "frame_type": {
      "type": "string",
      "const": "aggregate.timeline",
      "description": "Canonical frame-type identifier used for routing and engine selection."
    },
    "subject": {
      "description": "Optional entity the timeline is primarily about (person, organization, conflict, project, etc.).",
      "$ref": "#/$defs/Entity"
    },
    "overall_span": {
      "description": "Optional TimeSpan summarizing the temporal coverage of the timeline as a whole (earliest to latest relevant dates).",
      "$ref": "#/$defs/TimeSpan"
    },
    "focus_interval": {
      "description": "Optional TimeSpan marking the interval that should be emphasized in summaries (e.g. 'World War II period', 'first decade of career').",
      "$ref": "#/$defs/TimeSpan"
    },
    "entries": {
      "type": "array",
      "description": "Ordered list of TimelineEntry objects representing the constituent events. Intended (but not required) to be in chronological order.",
      "items": {
        "$ref": "#/$defs/TimelineEntry"
      }
    },
    "grouping_hint": {
      "type": "string",
      "nullable": true,
      "description": "Optional high-level hint about how entries should be grouped for presentation, e.g. 'by_phase', 'by_decade', 'by_century', 'by_topic'. Engines may ignore this."
    },
    "attributes": {
      "type": "object",
      "description": "Generic attribute map for timeline-level structured data, such as display limits or phase ordering hints. Keys are free-form strings; values should be JSON-serializable.",
      "additionalProperties": true
    },
    "extra": {
      "type": "object",
      "description": "Opaque metadata bag for pipeline-specific information (original payloads, provenance, debugging flags). Not interpreted by language-neutral NLG logic.",
      "additionalProperties": true
    }
  },
  "required": [
    "frame_type",
    "entries"
  ],
  "$defs": {
    "TimeSpan": {
      "type": "object",
      "description": "Simple representation of a temporal span or point in time. All fields are optional; at least one of the year fields SHOULD be provided.",
      "additionalProperties": false,
      "properties": {
        "start_year": {
          "type": "integer",
          "description": "Start year of the span."
        },
        "end_year": {
          "type": "integer",
          "description": "End year of the span, if different from start_year."
        },
        "start_month": {
          "type": "integer",
          "minimum": 1,
          "maximum": 12,
          "description": "Start month (1–12), optional."
        },
        "start_day": {
          "type": "integer",
          "minimum": 1,
          "maximum": 31,
          "description": "Start day of month (1–31), optional."
        },
        "end_month": {
          "type": "integer",
          "minimum": 1,
          "maximum": 12,
          "description": "End month (1–12), optional."
        },
        "end_day": {
          "type": "integer",
          "minimum": 1,
          "maximum": 31,
          "description": "End day of month (1–31), optional."
        },
        "approximate": {
          "type": "boolean",
          "description": "If true, the span or date is approximate (circa)."
        },
        "extra": {
          "type": "object",
          "description": "Free-form metadata associated with this TimeSpan.",
          "additionalProperties": true
        }
      }
    },
    "Entity": {
      "type": "object",
      "description": "Lightweight entity representation compatible with semantics.types.Entity. This may be inline or an expanded reference to an external entity catalog.",
      "additionalProperties": true,
      "properties": {
        "id": {
          "type": "string",
          "description": "Stable identifier for the entity (e.g. Wikidata QID or local ID)."
        },
        "name": {
          "type": "string",
          "description": "Human-readable label for the entity in the target language/script."
        },
        "human": {
          "type": "boolean",
          "description": "Indicates whether this entity is a human person."
        }
      }
    },
    "Event": {
      "type": "object",
      "description": "Core event representation compatible with semantics.types.Event. The schema is intentionally permissive; downstream logic may expect particular properties for specific event families.",
      "additionalProperties": true,
      "properties": {
        "id": {
          "type": "string",
          "description": "Stable identifier for the event, if any."
        },
        "event_type": {
          "type": "string",
          "description": "High-level label for the event type (e.g. 'birth', 'award', 'battle', 'treaty')."
        },
        "participants": {
          "type": "object",
          "description": "Mapping from role label to Entity participating in the event.",
          "additionalProperties": {
            "$ref": "#/$defs/Entity"
          }
        },
        "time": {
          "description": "Primary time span associated with the event.",
          "$ref": "#/$defs/TimeSpan"
        },
        "location": {
          "type": "object",
          "description": "Optional location object. Shape is intentionally not constrained; projects may align this with semantics.types.Location.",
          "additionalProperties": true
        },
        "properties": {
          "type": "object",
          "description": "Structured event-specific properties (e.g. casualty counts, award name).",
          "additionalProperties": true
        },
        "extra": {
          "type": "object",
          "description": "Opaque metadata, original source representation, IDs, etc.",
          "additionalProperties": true
        }
      }
    },
    "TimelineEntry": {
      "type": "object",
      "description": "Single entry in a timeline / chronology. Wraps a core Event together with optional label, time override, phase, and salience.",
      "additionalProperties": false,
      "properties": {
        "event": {
          "description": "Underlying Event this entry refers to. Often provides the primary temporal ordering signal.",
          "$ref": "#/$defs/Event"
        },
        "label": {
          "type": "string",
          "nullable": true,
          "description": "Optional short label or description (e.g. 'Birth', 'First Nobel Prize'). May be used as a heading or bullet text."
        },
        "time_span": {
          "description": "Optional explicit TimeSpan for this entry. If provided, this should be preferred for ordering and display; otherwise, event.time (if any) is used.",
          "$ref": "#/$defs/TimeSpan"
        },
        "phase": {
          "type": "string",
          "nullable": true,
          "description": "Optional coarse grouping label to cluster entries into phases (e.g. 'early_life', 'career', 'later_years', 'phase_1')."
        },
        "salience": {
          "type": "number",
          "description": "Relative importance weight for the entry. 1.0 represents 'normal' importance; higher values should be preferred when output must be shortened.",
          "default": 1.0
        },
        "extra": {
          "type": "object",
          "description": "Opaque metadata or implementation-specific details for this entry. Not interpreted by language-neutral NLG logic.",
          "additionalProperties": true
        }
      },
      "required": [
        "event"
      ]
    }
  }
}
